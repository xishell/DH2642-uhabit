@import 'tailwindcss';
@import '@skeletonlabs/skeleton';
@import '@skeletonlabs/skeleton-svelte';
@import '@skeletonlabs/skeleton/themes/cerberus';

@import '../midnight.css';

/* Enable class-based and data-attribute dark mode for Tailwind v4 */
@custom-variant dark (&:where(.dark, .dark *, [data-mode="dark"], [data-mode="dark"] *));

/* Smooth theme transitions */
@layer base {
	html,
	body {
		overflow-x: hidden;
		height: 100%;
		margin: 0;
		padding: 0;
		overscroll-behavior: none;
	}

	html {
		scrollbar-gutter: stable;
	}

	body {
		min-height: 100dvh;
	}

	html,
	body {
		background-color: oklch(98.5% 0 none);
	}

	html {
		transition:
			background-color 0.3s ease,
			color 0.3s ease;
	}

	html.dark,
	html[data-mode='dark'],
	.dark body,
	[data-mode='dark'] body {
		background-color: oklch(22% 0 none);
	}

	body,
	main,
	header,
	aside,
	nav,
	.card,
	.btn,
	button,
	input,
	textarea,
	select {
		transition:
			background-color 0.3s ease,
			color 0.3s ease,
			border-color 0.3s ease;
	}
}

/* View Transitions API - Keep header static */
header {
	view-transition-name: header;
}

::view-transition-group(header),
::view-transition-group(nav-avatar),
::view-transition-group(avatar-menu) {
	animation: none;
}

/* View Transitions API animations */

/* Background to prevent black flash - matches theme */
::view-transition-group(root) {
	background: oklch(22% 0 none);
}

:root:not(.dark):not([data-mode='dark'])::view-transition-group(root) {
	background: oklch(98.5% 0 none);
}

/* Slide animations */
@keyframes slide-out-to-left {
	to {
		transform: translateX(-100%);
	}
}

@keyframes slide-in-from-right {
	from {
		transform: translateX(100%);
	}
}

@keyframes slide-out-to-right {
	to {
		transform: translateX(100%);
	}
}

@keyframes slide-in-from-left {
	from {
		transform: translateX(-100%);
	}
}

/* Forward navigation: swipe left */
:root[data-nav-direction='forward']::view-transition-old(root) {
	animation: 250ms cubic-bezier(0.4, 0, 0.2, 1) both slide-out-to-left;
}

:root[data-nav-direction='forward']::view-transition-new(root) {
	animation: 250ms cubic-bezier(0.4, 0, 0.2, 1) both slide-in-from-right;
}

/* Back navigation: swipe right */
:root[data-nav-direction='back']::view-transition-old(root) {
	animation: 250ms cubic-bezier(0.4, 0, 0.2, 1) both slide-out-to-right;
}

:root[data-nav-direction='back']::view-transition-new(root) {
	animation: 250ms cubic-bezier(0.4, 0, 0.2, 1) both slide-in-from-left;
}

/* Reduce motion for users who prefer it (system or manual setting) */
@media (prefers-reduced-motion: reduce) {
	::view-transition-old(root),
	::view-transition-new(root) {
		animation: none;
	}
}

:root[data-reduce-motion='true']::view-transition-old(root),
:root[data-reduce-motion='true']::view-transition-new(root) {
	animation: none;
}

/* Global focus states for accessibility */
@layer base {
	/* Visible focus ring for all interactive elements */
	button:focus-visible,
	a:focus-visible,
	input:focus-visible,
	select:focus-visible,
	textarea:focus-visible,
	[role='button']:focus-visible,
	[tabindex]:focus-visible {
		outline: 2px solid oklch(65% 0.19 282deg); /* primary-400 */
		outline-offset: 2px;
	}

	/* Remove default outline since we're using custom focus ring */
	button:focus,
	a:focus,
	[role='button']:focus {
		outline: none;
	}

	/* Ensure focus is visible for keyboard navigation */
	:focus-visible {
		outline: 2px solid oklch(65% 0.19 282deg);
		outline-offset: 2px;
	}
}
