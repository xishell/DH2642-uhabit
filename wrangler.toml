name = "uhabit"
compatibility_date = "2025-11-26"
compatibility_flags = ["nodejs_compat"]

# Pages configuration
pages_build_output_dir = ".svelte-kit/cloudflare"

# D1 Database binding
# For local development, create a wrangler.local.toml file with your own database_id
# See docs/cloudflare-setup.md for setup instructions
[[d1_databases]]
binding = "DB"
database_name = "uhabit-db"
database_id = "local-dev-db"
migrations_dir = "drizzle"

# KV Namespace for rate limiting (persistent, distributed storage)
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "e007eb2bd5f1461aa48027aa85328a01"

# KV Namespace for quotes caching
[[kv_namespaces]]
binding = "QUOTES_CACHE"
id = "2af61397263c4a3aa886234d4fb1e1cd"
preview_id = "3efa594e3a38437f80337e9655ed707d"

# Environment configuration
# Note: Secrets like BETTER_AUTH_SECRET should be set via:
#   npx wrangler secret put BETTER_AUTH_SECRET --env preview
#   npx wrangler secret put BETTER_AUTH_SECRET --env production

[env.preview]
name = "uhabit-staging"

[[env.preview.d1_databases]]
binding = "DB"
database_name = "uhabit-db-staging"
database_id = "c1b6383c-5932-4187-bb5a-9d350832a255"
migrations_dir = "drizzle"

[[env.preview.kv_namespaces]]
binding = "RATE_LIMIT"
id = "c9e24aece36444eab3d8d708f8a90590"

[[env.preview.kv_namespaces]]
binding = "QUOTES_CACHE"
id = "d25b20ff2d5c4523ba874e3799a9b89d"

[env.preview.vars]
DEV_MODE = "true"

[env.production]
name = "uhabit"

[[env.production.d1_databases]]
binding = "DB"
database_name = "uhabit-db-production"
database_id = "947d30fd-474e-4e78-b65d-2d89b41212f4"
migrations_dir = "drizzle"

[[env.production.kv_namespaces]]
binding = "RATE_LIMIT"
id = "92c7011c659d4a01a759cab698729751"

[[env.production.kv_namespaces]]
binding = "QUOTES_CACHE"
id = "61404831084147e1b7927aed84882e4b"

[env.production.vars]
DEV_MODE = "false"
